/* ==========================================================================
   CiteSpine UI v0 — tokens + base + components (single consolidated file)
   ========================================================================== */

/* ----------------------------- Design Tokens ----------------------------- */
:root{
  /* spacing (8pt scale) */
  --s-0:0; --s-1:4px; --s-2:8px; --s-3:12px; --s-4:16px; --s-5:24px;
  --s-6:32px; --s-7:48px; --s-8:64px;

  /* radii */
  --radius:16px;        /* cards, large containers */
  --radius-sm:12px;     /* inputs, buttons, chips */

  /* elevation (shadows) */
  --e-sm:0 4px 16px rgba(0,0,0,.25);
  --e-md:0 8px 30px rgba(0,0,0,.35);
  --e-lg:0 14px 50px rgba(0,0,0,.5);

  /* type scale */
  --fs-12:12px; --fs-14:14px; --fs-16:16px; --fs-18:18px; --fs-22:22px; --fs-28:28px;
  --lh-tight:1.35; --lh-normal:1.5;

  /* palette */
  --bg:#0b0c10; --surface:#0e1118; --card:#101421;
  --muted:#a9b0c0; --text:#f5f7fb;
  --accent:#5aa0ff; --accent2:#7dd3fc;
  --border:rgba(255,255,255,.06);
  --ok:#34d399; --err:#ef4444;

  /* subtle fx */
  --shadow-sm: var(--e-sm);
  --shadow:    var(--e-md);

  /* ---- Brand sizing tokens ---- */
  /* Header/brand scale. Tweak 64–72 for taste. */
  --brand-h: 72px;          /* target visual height of the logo */
  --brand-fs: var(--fs-22); /* brand wordmark size */
}

/* ------------------------------ Base / Reset ----------------------------- */
*{box-sizing:border-box}
html,body,#root{height:100%}
body{
  margin:0;
  background:radial-gradient(1200px 600px at 10% 0%, #0f1320 0%, #0b0c10 60%);
  color:var(--text);
  font:15px/var(--lh-normal) Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}

/* ------------------------------- Layout ---------------------------------- */
.container{max-width:1200px; margin:0 auto; padding:var(--s-6) var(--s-5)}
.grid{display:grid; gap:var(--s-6); grid-template-columns:1fr 1.2fr}
@media (max-width:980px){.grid{grid-template-columns:1fr}}

.card{
  background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01)), var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:var(--s-5);
  box-shadow:var(--shadow-sm);
  transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease;
  backdrop-filter: blur(2px);
}
.card:hover{transform:translateY(-1px); box-shadow:var(--shadow); border-color:rgba(255,255,255,.09)}

h1,h2,h3{line-height:var(--lh-tight); margin:0 0 var(--s-3)}
h1{font-size:var(--fs-28)} h2{font-size:var(--fs-22)} h3{font-size:var(--fs-18)}
.muted{color:var(--muted)}

/* -------------------------------- Header --------------------------------- */
.hdr{display:flex; justify-content:space-between; align-items:center; margin-bottom:var(--s-5)}
/* Header brand row */
.brand{
  display:flex; align-items:center; gap:var(--s-3);
  font-weight:700; letter-spacing:.2px; font-size: var(--brand-fs);
}
/* Blue dot scales with brand size to keep proportion */
.brand-dot{
  width:  calc(var(--brand-h) * 0.18);
  height: calc(var(--brand-h) * 0.18);
  border-radius: 50%;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  box-shadow: 0 0 0 calc(var(--brand-h) * 0.06) rgba(90,160,255,.15);
}
.nav{display:flex; gap:var(--s-4)}
.nav-link{
  color:var(--muted); text-decoration:none; border:1px solid transparent;
  padding:6px 8px; border-radius:999px; font-size:var(--fs-14)
}
.nav-link:hover{border-color:var(--border)}

.pill{
  background:#171c2a; color:var(--muted); border:1px solid var(--border);
  padding:6px 12px; border-radius:999px; font-size:var(--fs-12); cursor:pointer;
  transition:transform .06s ease, border-color .12s ease;
}
.pill:hover{border-color:rgba(255,255,255,.12); transform:translateY(-1px)}

/* About sheet (modal) */
.sheet{position:fixed; inset:0; background:rgba(0,0,0,.45); display:grid; place-items:center; z-index:80}
.sheet-box{
  width:min(560px, 92vw);
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:18px;
  box-shadow:var(--shadow);
}

/* -------------------------------- Footer --------------------------------- */
.ftr-outer{margin-top:var(--s-6); padding:var(--s-4) 0; color:var(--muted)}
.ftr-inner{
  display:flex; gap:var(--s-4); justify-content:space-between; align-items:center;
  border-top:1px solid var(--border); padding-top:var(--s-3)
}
.ftr-links{display:flex; gap:var(--s-2); align-items:center}
.ftr{margin-top:var(--s-5); color:var(--muted); text-align:center} /* legacy footer line, keep for compatibility */

/* ----------------------------- Inputs & Forms ----------------------------- */
.form .ta{
  width:100%; min-height:96px; resize:vertical;
  background:#0f1220; border:1px solid #1e2538; color:var(--text);
  border-radius:var(--radius-sm); padding:12px;
}

/* Strictly prevent horizontal resize on the Ask textarea */
textarea.ta {
  width: 100%;
  max-width: 100%;
  resize: vertical !important;   /* vertical only */
  max-height: 220px;             /* cap height per design */
  overflow: auto;
}

.ta.err{border-color:var(--err)}

.help{font-size:var(--fs-12); color:var(--muted); margin:var(--s-3) 2px var(--s-2)}
.errc{color:var(--err)}

.row{display:grid; gap:var(--s-4); grid-template-columns:1fr 1fr; margin:var(--s-4) 0}
.row.small{grid-template-columns:100px 100px; align-items:center}
input{
  width:100%; background:#0f1220; border:1px solid #1e2538; color:var(--text);
  border-radius:var(--radius-sm); padding:9px 11px; font-size:var(--fs-14)
}

/* number input: remove native spinners, unify style */
input[type=number]::-webkit-outer-spin-button,
input[type=number]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
input[type=number]{appearance:textfield;}
.num{
  width:96px; text-align:center; border-radius:var(--radius-sm);
  background:#0f1220; border:1px solid #1e2538; color:var(--text);
  padding:8px 8px; font-size:var(--fs-14)
}

/* Buttons */
.btn{
  background:linear-gradient(135deg, var(--accent), var(--accent2)); color:#001022;
  border:0; border-radius:var(--radius-sm); padding:10px 14px; cursor:pointer; font-weight:600;
  box-shadow:0 8px 24px rgba(90,160,255,.2);
}
.btn.ghost{background:transparent; color:var(--text); border:1px solid #2a3248; box-shadow:none}
.btn:disabled{filter:grayscale(.6); cursor:not-allowed}
.btn:focus,.ta:focus,input:focus{outline:2px solid var(--accent2); outline-offset:2px; border-color:transparent}

/* ------------------------------- Dropzone -------------------------------- */
.drop{
  position:relative;
  background:#0f1220;
  border:1px dashed #2a3248;
  border-radius:14px;
  padding:28px;
  text-align:center;
  overflow:hidden;
  transition:border-color .2s, background .2s, box-shadow .2s;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.03); /* subtle inner ring at rest */
}
.drop.hover{border-color:var(--accent); background:#0f1428; box-shadow:0 0 0 2px rgba(90,160,255,.15) inset}
.drop .pulse{
  position:absolute; inset:0; pointer-events:none;
  background:radial-gradient(720px 720px at 50% 0%, rgba(90,160,255,.085), transparent 62%);
  animation:fade 2.8s ease-in-out infinite
}
@keyframes fade{0%,100%{opacity:.2}50%{opacity:.45}}
.drop p{margin:0 0 var(--s-3); color:var(--muted)}
.drop.busy{opacity:.75; filter:saturate(.9)}

/* --------------------------- Chips & Suggestions -------------------------- */
.chips{display:flex; flex-wrap:wrap; gap:var(--s-2); margin-bottom:var(--s-2)}
.chip{
  background:#171c2a; color:var(--text); border:1px solid #2a3248;
  border-radius:999px; padding:6px 10px; cursor:pointer;
  transition:border-color .12s ease, transform .06s ease;
}
.chip:hover{border-color:var(--accent)} .chip:active{transform:scale(.98)}

/* -------------------------------- Answer --------------------------------- */
.answer{
  background:#0f1220; border:1px solid #1e2538; padding:14px; border-radius:var(--radius-sm); white-space:pre-wrap;
  box-shadow:inset 0 0 0 1px rgba(255,255,255,.01);
}

/* ------------------------------- Citations -------------------------------- */
.cites{display:grid; gap:var(--s-3); margin-top:var(--s-3)}
.cite{border:1px solid #1e2538; border-radius:var(--radius-sm); padding:12px; background:#0f1220}
.cite .meta{display:flex; flex-wrap:wrap; gap:var(--s-2); align-items:center; margin-bottom:6px}
.badge{background:#171c2a; color:var(--muted); padding:2px 8px; border-radius:999px; font-size:var(--fs-12); border:1px solid #2a3248}
.snippet{color:#e6ebf5}
.empty{color:var(--muted)}

/* -------------------------------- Toasts --------------------------------- */
.toast-wrap{position:fixed; right:18px; bottom:18px; display:grid; gap:var(--s-2); z-index:60}
.toast{
  padding:10px 12px; border-radius:var(--radius-sm); background:#171c2a; color:var(--text);
  border:1px solid #2a3248; cursor:pointer; box-shadow:var(--shadow-sm); animation:toast-in .18s ease-out both;
}
.toast.ok{border-color:var(--ok); color:#d1fae5}
.toast.err{border-color:var(--err); color:#fee2e2}
.toast.info{border-color:#3b82f6; color:#dbeafe}
@keyframes toast-in{from{transform:translateY(6px);opacity:0}to{transform:translateY(0);opacity:1}}

/* ------------------------------- Loading --------------------------------- */
.spin{width:18px;height:18px;border:3px solid #2a3248;border-top-color:var(--accent);border-radius:50%;animation:sp 1s linear infinite}
@keyframes sp{to{transform:rotate(360deg)}}

/* Premium skeleton shimmer */
.skel{display:grid; gap:var(--s-2)}
.skel-line{
  height:12px; border-radius:8px;
  background:linear-gradient(90deg,#151a28 25%,#1e2536 37%,#151a28 63%);
  background-size:400% 100%; animation:shimmer 1.2s ease-in-out infinite;
}
@keyframes shimmer{0%{background-position:100% 0}100%{background-position:0 0}}

/* ------------------------------ History List ------------------------------ */
.hist-list{display:grid; gap:var(--s-2)}
.hist-item{
  display:flex; align-items:center; justify-content:space-between;
  border:1px solid var(--border); border-radius:var(--radius-sm);
  padding:8px 10px; background:#0f1220
}
.hist-text{background:transparent; border:0; color:var(--text); text-align:left; cursor:pointer}
.hist-text:hover{text-decoration:underline}
.hist-actions{display:flex; gap:var(--s-2)}
.icon{
  background:#171c2a; color:var(--muted); border:1px solid #2a3248; border-radius:8px; padding:2px 8px; cursor:pointer
}
.icon:hover{border-color:var(--accent)}
.icon.on{color:#ffd166; border-color:#ffd166}

/* --- small refinements for this patch --- */

/* cap textarea growth */
.form .ta { max-height: 220px; }

/* section spacing utilities to replace inline margins */
.section    { margin-top: var(--s-5); }
.section-sm { margin-top: var(--s-3); }

/* header nav as button‑links (we'll use buttons, not anchors) */
.nav .btn-link{
  background:transparent; border:1px solid transparent; color:var(--muted);
  padding:6px 8px; border-radius:999px; cursor:pointer; font-size:var(--fs-14);
}
.nav .btn-link:hover{ border-color: var(--border); }

/* footer link treatment */
.ftr-links a{
  color:var(--muted); text-decoration:none; padding:4px 6px; border-radius:8px; border:1px solid transparent;
}
.ftr-links a:hover{ border-color: var(--border); }

/* Logo image — scale with brand token */
.logo-img{
  height: var(--brand-h);
  width: auto;
  display: block;              /* avoid inline-img baseline quirks */
  object-fit: contain;
  border-radius: 6px;
  mix-blend-mode: screen;
  filter: invert(1) contrast(1.1) brightness(1.05);
  margin-right: var(--s-2);
}

/* Optional: if your PNG has large white padding, add this class to gently zoom.
   Remove once you replace with a trimmed transparent PNG/SVG. */
.logo-tight{
  transform: scale(1.2);
  transform-origin: left center;
}

/* empty history card text */
.empty-card{ color: var(--muted); }